---
title: "Pay"
output: 
  flexdashboard::flex_dashboard:
    vertical_layout: scroll
    orientation: rows
---
  
```{r setup, include = FALSE}

knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)

knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())

```

```{r prep_data}

library(highcharter)
charts_n <- readRDS("data/charts_earnings.rds")[["regions"]][["nominal"]]
charts_r <- readRDS("data/charts_earnings.rds")[["regions"]][["real"]]
charts_l <- readRDS("data/charts_earnings.rds")[["regions"]][["latest"]]
regions <- names(charts_n)

```

#### Earnings data

The charts show median gross earnings of employees (without adjusting for inflation). Data is collected by the Office for National Statistics each April via the [Annual Survey of Hours and Earnings](https://www.ons.gov.uk/employmentandlabourmarket/peopleinwork/earningsandworkinghours/bulletins/annualsurveyofhoursandearnings/latest). The statistics cover employees only and exclude self-employed earnings.

Data is available on a council-area level, but not on Scottish Parliament constituency or region level. This page includes council areas that are within or overlap with the selected Scottish Parliament region.

```{r, results='asis'}

# add layout and charts by looping through regions

src = lapply(seq_along(regions), function(x) {
  x <- regions[x]
  knitr::knit_expand('dashboard/_layouts/earnings_layout.Rmd')
})

res = knitr::knit_child(text = unlist(src), quiet = TRUE)
cat(res, sep = '\n')

```
