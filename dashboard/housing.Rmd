---
title: "Housing"
output: 
  flexdashboard::flex_dashboard:
    vertical_layout: scroll
    orientation: rows
---

```{r setup, include = FALSE}

knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)

knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())

```

```{r prep_data}

library(highcharter)
charts_housing <- readRDS("data/charts_housing.rds")
regions <- names(charts_housing$house_prices)

```

#### Housing statistics

- [Median house prices data is from Registers of Scotland](https://statistics.gov.scot/resource?uri=http%3A%2F%2Fstatistics.gov.scot%2Fdata%2Fresidential-properties-sales-and-price)
- Housing affordability uses the house price data above alongside [weekly median gross employee earnings data from the Annual Survey of Hours and Earnings](https://www.ons.gov.uk/employmentandlabourmarket/peopleinwork/earningsandworkinghours/datasets/annualsurveyofhoursandearningsasheguidetotables) 
- [Council tax data is from National Records of Scotland](https://statistics.gov.scot/data/dwellings-by-council-tax-band-detailed-current-geographic-boundaries)
- Tenure data is from the [Scottish Census 2011](https://www.scotlandscensus.gov.uk/search-the-census#/)

Further data: overcrowding (Census); social housing waitlists; house builidng; EPC data

```{r, results='asis'}

# add layout and charts by looping through regions

src = lapply(seq_along(regions), function(x) {
  x <- regions[x]
  knitr::knit_expand('dashboard/layouts/housing_layout.Rmd')
})

res = knitr::knit_child(text = unlist(src), quiet = TRUE)
cat(res, sep = '\n')

```
